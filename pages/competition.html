<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Upforce by Andre Fonseca</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="../stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="../stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="../stylesheets/github-light.css" media="screen">
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript" src="../js/helpers.js"></script>
    <script type="text/javascript" src="../js/logic.js"></script>
    <script type="text/javascript" src="../js/database.js"></script>
    <script type="text/javascript">
      google.charts.load('current', {'packages':['table']});

      var year = getURLParams("year");
      var competition = getURLParams("competition");

      //TODO: Competition page

      document.title = "Upforce :: " + year + " " + competition;

      google.charts.setOnLoadCallback(function() {
        for (var i = 0; i < categories.male.length; i++) {
          drawCategoryChart(year, competition, "male", categories.male[i]);
        }

        for (var i = 0; i < categories.female.length; i++) {
          drawCategoryChart(year, competition, "female", categories.female[i]);
        }
      });

      function drawCategoryChart(year, competition, gender, category) {

        var query = getCompetitionResults(year, competition, gender, category);

        query.send(function handleQueryResponse(response) {

          if (response.isError()) {
            return;
          }

          var data = response.getDataTable();

          if (data.getNumberOfRows() == 0) {
            return;
          }

          // Table title
          var h = document.createElement("H2");
          h.innerHTML = gender + " " + category;

          var table = document.getElementById("table_div");
          table.insertBefore(h, document.getElementById('table_div_' + gender + '_' + category));

          // Format table values
          for (var i = 0; i < data.getNumberOfRows(); i++) {
            var athleteName = data.getValue(i, 1);
            var team = data.getValue(i, 2);
            data.setValue(i, 1, "<a href=../pages/athlete.html?name=" + encodeURIComponent(athleteName) + ">" + athleteName + "</a>");
            data.setValue(i, 2, "<a href=../pages/team.html?name=" + encodeURIComponent(team) + ">" + team + "</a>");
          }

          // Set columns size
          data.setProperty(0, 0, 'style', 'width:200px');
          data.setProperty(0, 1, 'style', 'width:150px');

          // Draw table
          var wrapper = new google.visualization.ChartWrapper({
            chartType: 'Table',
            dataTable: data,
            options: {
              width: '100%', //height: '100px',
              columnProperty: (0, 'style', 'width:200px'),
              alternatingRowStyle: true,
              sortAscending: false,
              sortColumn: 4,
              allowHtml: true
            },
            containerId: 'table_div_' + gender + '_' + category
          });

          wrapper.draw();
        });
      }
    </script>
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Upforce</h1>
      <h2 class="project-tagline">Portuguese weightlifting statistics</h2>
      <a href="https://github.com/andrewfonseca/upforce" class="btn">View on GitHub</a>
    </section>

    <section class="main-content">
      <h3>

<a id="initial_title" class="anchor" href="#welcome-to-github-pages" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a></h3>

<div id="table_div" position="absolute">
  <div id="table_div_male_56"></div>
  <div id="table_div_male_62"></div>
  <div id="table_div_male_69"></div>
  <div id="table_div_male_77"></div>
  <div id="table_div_male_85"></div>
  <div id="table_div_male_94"></div>
  <div id="table_div_male_105"></div>
  <div id="table_div_male_105+"></div>
  <div id="table_div_female_48"></div>
  <div id="table_div_female_53"></div>
  <div id="table_div_female_58"></div>
  <div id="table_div_female_63"></div>
  <div id="table_div_female_69"></div>
  <div id="table_div_female_75"></div>
  <div id="table_div_female_75+"></div>
</div>

<script type="text/javascript">
  document.getElementById("initial_title").innerHTML = getURLParams("year") + " " + getURLParams("competition");
</script>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/andrewfonseca/upforce">Upforce</a> is maintained by <a href="https://github.com/andrewfonseca">andrewfonseca</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>


  </body>
</html>
